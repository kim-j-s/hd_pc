<!doctype html>
<html>

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
	<title>현대해상 다이렉트 - PC</title>
	<style>
		html {
			font-size: 62.5%;
		}

		.p-c1 {
			color: #cca700 !important;
			letter-spacing: 2px;
		}

		.p-c2 {
			color: #89d185 !important;
			letter-spacing: 2px;
		}

		html,
		body {
			background-color: #333;
			color: #fff;
		}

		body {
			margin: 0;
			padding: 0;
			font-size: 12px;
		}

		header {
			position: fixed;
			left: 0;
			top: 0;
			box-sizing: border-box;
			display: -webkit-flex;
			display: flex;
			-webkit-align-items: center;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			padding: 10px;
			background: #000;
			color: #fff;
			z-index: 1;
		}

		header h1 {
			margin: 0;
			font-size: 20px;
			line-height: 26px;
		}

		header .control_list {
			font-size: 0;
			margin-left: 10px;
		}

		header .control_list button {
			display: inline-block;
			position: relative;
			width: 20px;
			height: 20px;
			margin-left: 5px;
			background: #ddd;
			color: #000;
			border: 0;
			border-radius: 3px;
			text-align: center;
		}

		header .control_list button::before {
			content: "";
			display: block;
			position: absolute;
			left: 20%;
			top: 9px;
			height: 2px;
			background: #000;
			width: 60%;
		}

		header .control_list .open_all::after {
			content: "";
			display: block;
			position: absolute;
			left: 20%;
			top: 9px;
			height: 2px;
			background: #000;
			width: 60%;
			transform: rotateZ(90deg);
		}

		.main {
			margin: 60px 10px 10px;
		}

		.main h2 {
			font-size: 18px;
			line-height: 22px;
			cursor: pointer;
		}

		.main h2::before {
			content: "-";
			display: inline-block;
			vertical-align: top;
			text-align: center;
			width: 16px;
			height: 16px;
			line-height: 14px;
			border-radius: 8px;
			background-color: #000;
			color: #fff;
			margin: 4px 5px 0 0;
		}

		.main h2.on::before {
			content: "+";
		}

		.main h2.on+table {
			display: none;
		}

		table {
			width: 100%;
			border-collapse: collapse;
			table-layout: fixed;
			word-break: break-all;
		}

		table a {
			position: relative;
			color: #fff;
		}

		.note + td {
			text-align: center;
		}

		tr {
			border-top: 1px solid #000;
			border-bottom: 1px solid #000;
		}

		th,
		td {
			padding: 5px 10px;
			border-left: 1px solid #000;
			border-right: 1px solid #000;
			font-size: 12px;
		}

		th {
			color: #fff;
			background: #666;
		}

		th:first-child {
			border-left: 1px solid #000;
		}

		th:last-child {
			border-right: 1px solid #000;
		}

		.delete {
			text-dECOration: line-through;
			color: #ff0000;
		}

		.delete a {
			text-dECOration: line-through;
			color: #ff0000;
		}

		.complete {
			text-align: center;
		}

		.complete.ok::after {
			/* content: "△"; */
			content: "O";
		}
		.complete.ok.fix::after {
			content: "O";
		}

		.bigo2 {
			background-color: #4691af;
		}
		.bigo2:empty {
			background-color: transparent;
		}
		.bigo2.ing {
			background-color: #f8633c;
		}
		.bigo2.ing::after {
			display: block;
			content: "기획 정의중";
		}
		.bigo2.design {
			background-color: #cca700;
		}
		.bigo2.design::after {
			display: block;
			content: "디자인 확인 필요";
		}
		.del {
			text-decoration: line-through;
			background: #aaa !important;
		}
		.del .end_date {
			background: #aaa !important;
		}
		.del .bigo2::after {
			content: "삭제";
		}

		tbody tr:nth-child(2n) {
			background: #444;
		}

		tbody tr:hover td {
			color: #fff;
			background-color: #68b95e !important;
		}

		tbody tr:hover td a {
			color: #fff;
		}

		tbody tr.red td {
			background-color: red;
		}

		tbody tr.red td a {
			color: #fff;
		}

		.title {
			display: table-row !important;
			cursor: pointer;
		}

		.title th {
			text-align: left;
			font-size: 14px;
			line-height: 22px;
			letter-spacing: 1px;
			background: #000;
			padding: 8px 10px;
			border-top: 3px solid #888;
		}

		colgroup+thead .title th {
			border-top: 0;
		}

		.title .inner {
			display: flex;
		}

		.title .inner::before {
			content: "";
			display: inline-block;
			vertical-align: top;
			width: 0;
			height: 0;
			border-left: 5px solid transparent;
			border-right: 5px solid transparent;
			border-top: 0;
			border-bottom: 8px solid #fff;
			margin: 7px 10px 0 0;
		}

		.mini tr,
		.mini+tbody {
			display: none;
		}
		

		.mini .title th::before {
			border-left: 5px solid transparent;
			border-right: 5px solid transparent;
			border-top: 8px solid #fff;
			border-bottom: 0;
		}

		#mode_toggle {
			display: none;
		}

		#mode_toggle+label {
			position: fixed;
			right: 10px;
			bottom: 10px;
			display: block;
			width: 24px;
			height: 24px;
			line-height: 24px;
			border-radius: 3px;
			background-color: #000;
			color: #fff;
			text-align: center;
			z-index: 1;
		}

		#mode_toggle+label::before {
			content: "";
			display: block;
			position: absolute;
			height: 2px;
			width: 60%;
			background: #fff;
			left: 50%;
			top: 50%;
			transform: translate(-50%, -50%);
		}

		#mode_toggle+label::after {
			content: "";
			display: block;
			position: absolute;
			height: 2px;
			width: 60%;
			background: #fff;
			left: 50%;
			top: 50%;
			transform: translate(-50%, -50%);
		}

		#mode_toggle:checked+label::after {
			transform: translate(-50%, -50%) rotateZ(90deg);
		}

		#mode_toggle:checked~.main .mini tr,
		#mode_toggle:checked~.main .mini+tbody {
			display: none;
		}

		#mode_toggle:checked~.main colgroup {
			display: none;
		}

		#mode_toggle:checked~.main table,
		#mode_toggle:checked~.main tbody,
		#mode_toggle:checked~.main thead,
		#mode_toggle:checked~.main tr {
			display: block;
			width: 100%;
		}

		#mode_toggle:checked~.main thead tr {
			display: none;
		}

		#mode_toggle:checked~.main thead th {
			display: block;
		}

		#mode_toggle:checked~.main thead tr.title {
			display: block !important;
		}

		#mode_toggle:checked~.main tbody tr {
			display: flex;
			flex-wrap: wrap;
			border-top: 0;
			border-bottom: 1px solid white;
			padding-top: 5px;
			padding-bottom: 5px;
			font-size: 0;
		}

		#mode_toggle:checked~.main tbody td {
			display: inline-block;
			vertical-align: top;
			border: 0;
		}

		#mode_toggle:checked~.main tbody .link {
			display: block;
			width: 100%;
			border-top: 2px dotted black;
		}

		#mode_toggle:checked~.main tbody .complete {
			display: block;
			width: 100%;
			height: 0;
			padding: 0;
			overflow: hidden;
		}

		#mode_toggle:checked~.main tbody td:empty {
			display: none;
		}

		#mode_toggle:checked~.main tbody .complete.ok {
			border-top: 1px dashed yellow;
		}

		#mode_toggle:checked~.main tbody .complete~td {
			display: none;
			width: 100%;
			padding-top: 2px;
			padding-bottom: 2px;
			border: 0;
			text-align: left;
		}

		#mode_toggle:checked~.main tbody tr:nth-child(2n) {
			background: transparent;
		}

		.m-list {
			position: relative;
			margin: 0;
			padding: 25px 0 0 0;
		}

		.m-list::before {
			content: "수정일자";
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			font-weight: bold;
			line-height: 20px;
			text-align: center;
			background-color: #fff;
			color: #ff0000;
			overflow: hidden;
			white-space: nowrap;
			text-overflow: ellipsis;
		}

		.m-list li {
			position: relative;
			list-style: none;
			margin: 0;
			padding: 0 0 0 10px;
			color: #fff;
			line-height: 20px;
		}

		.m-list li::before {
			content: "";
			position: absolute;
			top: 9px;
			left: 0;
			width: 4px;
			border-bottom: 4px solid #fff;
			border-radius: 50%;
		}

		.m-list li+li {
			margin-top: 5px;
		}

		.rate {
			display: inline-flex;
			margin-left: auto;
		}

		.rate>span {
			position: relative;
			margin-right: 17px;
		}

		.rate>span::after {
			content: "";
			position: absolute;
			top: 50%;
			right: -8px;
			height: 12px;
			border-left: 1px solid #fff;
			transform: translateY(-50%);
		}

		.rate>span:last-child {
			margin-right: 0;
		}

		.rate>span:last-child:after {
			content: "%";
			position: relative;
			top: auto;
			right: auto;
			border-left: none;
		}

		.rate .rate_total::before {
			content: "전체 : ";
		}

		.rate .rate_late::before {
			content: "지연 : ";
		}

		.rate .rate_complete::before {
			content: "완료 : ";
		}

		.rate .rate_per::before {
			content: "진행률 : ";
		}

		.rate .rate_per::after {
			content: "%";
		}

		.idx_link {
			display: flex;
			align-items: center;
			gap: 10px;
			margin-bottom: 20px;
		}
		.idx_link a {
			flex: 1 1 0;
			display: block;
			padding: 10px;
			font-weight: bold;
			font-size: 24px;
			color: #333;
			text-align: center;
			background-color: #ddd;
			text-dECOration: none;
		}

		@media (max-width: 600px) {}
	</style>
</head>

<body>
	<div class="wrap">
		<!-- header -->
		<header>
			<h1>현대해상 다이렉트 - PC</h1>
			<div class="control_list">
				<button class="close_all"></button>
				<button class="open_all"></button>
			</div>
		</header>
		<!-- // header -->

		<input type="checkbox" id="mode_toggle" />
		<label for="mode_toggle"></label>
		<div class="main">
			<div class="idx_link">
				<a href="index.html">상품 목록 보기</a>
			</div>
			<!-- table -->
			<table>
				<colgroup>
					<col class="level" />
					<col class="level" />
					<col class="level" />
					<col class="level" />
					<col class="level" />
					<col class="level" />
					<col class="level" />
					<col class="end_day" />
					<col class="link" />
					<col class="complete" style="width: 60px" />
					<col class="note" style="width: 60px;" />
					<col class="comp-date" style="width: 110px" />
					<col class="modify-history" />
				</colgroup>

				<!-- common -->
				<thead class="mini">
				<!-- <thead> -->
					<tr class="title">
						<th colspan="13">
							<div class="inner">
								<span class="title_text">Common</span>
							</div>
						</th>
					</tr>
					<tr>
						<th>lv[1]</th>
						<th>lv[2]</th>
						<th>lv[3]</th>
						<th>lv[4]</th>
						<th>lv[5]</th>
						<th>lv[6]</th>
						<th>lv[7]</th>
						<th>마감일</th>
						<th>link</th>
						<th>완료</th>
						<th>비고</th>
						<th>확인 사항</th>
						<th>수정내역</th>
					</tr>
				</thead>
				<!-- // common -->

				<!-- 홈 -->
				<thead class="mini">
				<!-- <thead> -->
					<tr class="title">
						<th colspan="13">
							<div class="inner">
								<span class="title_text">홈</span>
								<span class="rate">
									<span class="rate_total"></span>
									<span class="rate_complete"></span>
									<span class="rate_late"></span>
									<span class="rate_per"></span>
								</span>
							</div>
						</th>
					</tr>
					<tr>
						<th>lv[1]</th>
						<th>lv[2]</th>
						<th>lv[3]</th>
						<th>lv[4]</th>
						<th>lv[5]</th>
						<th>lv[6]</th>
						<th>lv[7]</th>
						<th>마감일</th>
						<th>link</th>
						<th>완료</th>
						<th>비고</th>
						<th>확인 사항</th>
						<th>수정내역</th>
					</tr>
				</thead>
				<!-- // 홈 -->

				<!-- MY -->
				<thead class="mini">
				<!-- <thead> -->
					<tr class="title">
						<th colspan="13">
							<div class="inner">
								MY
								<span class="rate">
									<span class="rate_total"></span>
									<span class="rate_complete"></span>
									<span class="rate_late"></span>
									<span class="rate_per"></span>
								</span>
							</div>
						</th>
					</tr>
					<tr>
						<th>lv[1]</th>
						<th>lv[2]</th>
						<th>lv[3]</th>
						<th>lv[4]</th>
						<th>lv[5]</th>
						<th>lv[6]</th>
						<th>lv[7]</th>
						<th>마감일</th>
						<th>link</th>
						<th>완료</th>
						<th>비고</th>
						<th>확인 사항</th>
						<th>수정내역</th>
					</tr>
				</thead>
				<!-- // MY -->

				<!-- 혜택 -->
				<thead class="mini">
					<tr class="title">
						<th colspan="13">
							<div class="inner">
								혜택
								<span class="rate">
									<span class="rate_total"></span>
									<span class="rate_complete"></span>
									<span class="rate_late"></span>
									<span class="rate_per"></span>
								</span>
							</div>
						</th>
					</tr>
					<tr>
						<th>lv[1]</th>
						<th>lv[2]</th>
						<th>lv[3]</th>
						<th>lv[4]</th>
						<th>lv[5]</th>
						<th>lv[6]</th>
						<th>lv[7]</th>
						<th>마감일</th>
						<th>link</th>
						<th>완료</th>
						<th>비고</th>
						<th>확인 사항</th>
						<th>수정내역</th>
					</tr>
				</thead>
				<!-- // 혜택 -->

				<!-- 이용안내 -->
				<thead class="mini">
				<!-- <thead> -->
					<tr class="title">
						<th colspan="13">
							<div class="inner">
								고객지원(이용안내)
								<span class="rate">
									<span class="rate_total"></span>
									<span class="rate_complete"></span>
									<span class="rate_late"></span>
									<span class="rate_per"></span>
								</span>
							</div>
						</th>
					</tr>
					<tr>
						<th>lv[1]</th>
						<th>lv[2]</th>
						<th>lv[3]</th>
						<th>lv[4]</th>
						<th>lv[5]</th>
						<th>lv[6]</th>
						<th>lv[7]</th>
						<th>마감일</th>
						<th>link</th>
						<th>완료</th>
						<th>비고</th>
						<th>확인 사항</th>
						<th>수정내역</th>
					</tr>
				</thead>
				<!-- // 이용안내 -->

				<!-- 공통 -->
				<thead class="mini">
				<!-- <thead> -->
					<tr class="title">
						<th colspan="13">
							<div class="inner">
								공통
								<span class="rate">
									<span class="rate_total"></span>
									<span class="rate_complete"></span>
									<span class="rate_late"></span>
									<span class="rate_per"></span>
								</span>
							</div>
						</th>
					</tr>
					<tr>
						<th>lv[1]</th>
						<th>lv[2]</th>
						<th>lv[3]</th>
						<th>lv[4]</th>
						<th>lv[5]</th>
						<th>lv[6]</th>
						<th>lv[7]</th>
						<th>마감일</th>
						<th>link</th>
						<th>완료</th>
						<th>비고</th>
						<th>확인 사항</th>
						<th>수정내역</th>
					</tr>
				</thead>
				<!-- // 공통 -->
			</table>
			<!-- // table -->
		</div>
	</div>
	<script src="js/libs/jquery-1.8.3.min.js"></script>
	<script>
		document.querySelector(".control_list .close_all").onclick = function () {
			var el = document.querySelectorAll(".title");
			var len = el.length;
			if (len > 0) {
				for (var i = 0; i < len; i++) el[i].parentElement.classList.add("mini");
			}
		};

		document.querySelector(".control_list .open_all").onclick = function () {
			var el = document.querySelectorAll(".mini");
			var len = el.length;
			if (len > 0) {
				for (var i = 0; i < len; i++) el[i].classList.remove("mini");
			}
		};

		document.querySelectorAll(".main .title").forEach(el => {
			el.addEventListener("click", () => {
				// console.log("click");
				el.parentElement.classList.toggle("mini");
			});
		});



		$('.bigo').each(function(){
			const $this = $(this);
			const $thisText = $this.text();
			if( $thisText === '공통' ) {
				if( $this.closest('tr').find('.link a').text() == '' ) {
					// $this.css('background', 'green');
					$this.closest('tr').addClass('no_count');
				}
			}
		})
		
		
		// 수정내역 확인 목록
		let today = new Date();
		let year = today.getFullYear().toString().slice(-2);
		let month = ("0" + (today.getMonth() + 1)).slice(-2);
		let date = ("0" + today.getDate()).slice(-2);
		let dateString = year + "-" + month + "-" + date;

		function log(dateString) {
			const getValDate = dateString;

			// 페이지 작업자 확인 배열 생성
			const worker = [];
			$(".m-list").each(function () {
				$(this)
					.children("li")
					.each(function () {
						if ($(this).text().trim() === getValDate) {
							const title = $(this).closest("tr").find(".link > a").attr("title") || "담당자 미 지정";
							worker.push(title);
						}
					});
			});
			// console.log(worker);

			// 작업자 배열 확인
			const workers = [...new Set(worker)];

			let modifyListValue = [];
			for (var i = 0; i < workers.length; i++) {
				let modifyList = [];
				modifyList.push(workers[i]);
				$(".m-list").each(function () {
					$(this)
						.children("li")
						.each(function () {
							if ($(this).text().trim() === getValDate) {
								const title = $(this).closest("tr").find(".link > a").attr("title") || "담당자 미 지정";
								const pageName = $(this).closest("tr").find(".link > a").text();
								if (title === workers[i]) {
									let modify_page = "페이지명 : " + pageName;
									modifyList.push(modify_page);
								}
							}
						});
				});
				modifyListValue.push(modifyList);
			}

			let output = "";
			for (let item of modifyListValue) {
				output += item.join("\n") + "\n\n\n";
			}
			let printInfo = "[ " + dateString + " ] 모바일 퍼블리싱 수정내역 공유드립니다.\n\n\n" + output + "\n\n담당자가 지정되지 않은 경우 파트별로 확인 부탁드립니다.";

			console.log(printInfo);
		}

		// 출력
		// log('25-02-14');
		log(dateString);

		// 퍼블 지연 체크
		function endDate(dateString) {
			const [year, month, day] = dateString.split("-");
			const formattedDateString = `20${year}-${month}-${day}`;
			const today = new Date(formattedDateString);

			// if (isNaN(today)) {
			//   console.error('Invalid Date:', formattedDateString);
			//   return;
			// }

			// console.log('기준 날짜:', today);

			$(".end_date").each(function () {
				const endDateText = $(this).text().trim();
				// console.log('마감 날짜:', endDateText);
				// const endDate = new Date("20" + endDateText.replace(/-/g, "/"));
				const endDate = new Date(endDateText.replace(/-/g, "/"));
				const $tr = $(this).closest("tr");
				const $completeTd = $tr.find(".complete");

				// console.log('비교 날짜:', endDate);

				// 날짜 부분만 추출하여 비교
				const todayDateOnly = new Date(today.getFullYear(), today.getMonth(), today.getDate());
				const endDateOnly = new Date(endDate.getFullYear(), endDate.getMonth(), endDate.getDate());

				if (todayDateOnly > endDateOnly || endDateOnly.getTime() === todayDateOnly.getTime()) {
					$(this).addClass("ing");
				}

				// 날짜 비교 및 배경색 변경
				if (endDateOnly < todayDateOnly && !$completeTd.hasClass("ok")) {
					// console.log('지연');
					$(this).css("background-color", "red").addClass("late");
				} else if (endDateOnly.getTime() === todayDateOnly.getTime()) {
					// console.log('오늘 마감');
					$(this).css("background-color", "blue");
				} else if ($completeTd.hasClass("ok")) {
					// console.log('완료');
					$(this).css("background-color", "");
				}
			});
		}

		// 현재 날짜를 기준으로 endDate 함수 호출
		endDate(dateString);

		$("tbody").each(function () {
			const $tbody = $(this);

			// 'none' 클래스를 가진 tbody는 제외
			if ($tbody.hasClass("none")) {
				return;
			}

			// 'no_count' 클래스를 가진 tr을 제외하고 tr의 갯수를 계산
			const trCount = $tbody.find("tr").not(".no_count").length;

			// 이전 thead 안의 rate_total에 trCount를 텍스트로 설정
			$tbody.prev("thead").find(".rate_total").text(trCount);

			// 완료된 tr의 갯수를 계산
			const completECOunt = $tbody.find(".complete.ok").length;
			$tbody.prev("thead").find(".rate_complete").text(completECOunt);

			// 지연된 tr의 갯수를 계산
			const latECOunt = $tbody.find(".end_date").filter(".late").length;
			$tbody.prev("thead").find(".rate_late").text(latECOunt);

			// 오늘까지 작업해야 하는 페이지 총 갯수
			const todayEnd = $tbody.find(".end_date").filter(".ing").length;

			// const ratePer = Math.round((completECOunt / todayEnd) * 100);
			const ratePer = Math.round((completECOunt / trCount) * 100);
			const ratePerResult = isNaN(ratePer) ? 0 : ratePer;
			$tbody.prev("thead").find(".rate_per").text(ratePerResult);
		});

		function detectDevice() {
			const userAgent = navigator.userAgent.toLowerCase();

			// 모바일 기기 체크
			const isMobile = /iphone|ipad|ipod|android|blackberry|windows phone|opera mini|iemobile|mobile/i.test(userAgent);

			if (isMobile) {
				// console.log("모바일 기기입니다.");
				$("#mode_toggle").attr("checked", true);
				return "mobile";
			} else {
				// console.log("PC입니다.");
				return "pc";
			}
		}
		const deviceType = detectDevice();
		$(function () {

		});



	</script>
</body>

</html>