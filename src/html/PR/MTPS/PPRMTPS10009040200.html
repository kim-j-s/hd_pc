{{#> layout/default no-sp=true page-title="안내 팝업 | 상품"}}

<!-- s: Full 팝업 -->
{{#> popup/popup_full popup-id="pop_type01" popup-title="안내 팝업 " popup-active=true}}
<div class="popup_cont">
	<div class="popup_content">
		<!-- .process_info_area -->
		<div class="process_info_area">
			<div class="complete_info" aria-hidden="true">
				<lottie-player src="../../../json/lottie_info.jso" background="transparent" speed="1" autoplay></lottie-player>
			</div>
			<h2 class="process_title">
                <div class="logo_box">
                    <img src="../../../images/logo/cooperate_naver.png" alt="현대해상 다이렉트 제휴사 네이버">
                    <img src="../../../images/logo/cooperate_sk.png" alt="현대해상 다이렉트 제휴사 sk플래닛">
                    <img src="../../../images/logo/cooperate_banksalad.png" alt="현대해상 다이렉트 제휴사 banksalad">
                    <img src="../../../images/logo/cooperate_kakaopay.png" alt="현대해상 다이렉트 제휴사 kakaopay">
                    <img src="../../../images/logo/cooperate_coocon.png" alt="현대해상 다이렉트 제휴사 coocon">
                    <img src="../../../images/logo/cooperate_toss.png" alt="현대해상 다이렉트 제휴사 토스">
                    <img src="../../../images/logo/cooperate_payco.png" alt="현대해상 다이렉트 제휴사 NHN페이코">
                    <img src="../../../images/logo/cooperate_finda.png" alt="현대해상 다이렉트 제휴사 핀다">
                    <img src="../../../images/logo/cooperate_finnq.png" alt="현대해상 다이렉트 제휴사 핀크">
                    <img src="../../../images/logo/cooperate_habitfactory.png" alt="현대해상 다이렉트 제휴사 해빗팩토리">
                    <img src="../../../images/logo/cooperate_hectodata.png" alt="현대해상 다이렉트 제휴사 헥토데이터">
                </div>
				<strong>고객님, 보험 비교추천서비스를<br>나가시겠어요?</strong>
			</h2>
			<div class="process_desc">
				<!-- 보험료 계산 전 이탈팝업 -->
				지금 이동하시면<br>설계정보가 저장되지 않을 수 있어요.
			</div>
		</div>
		<!-- //.process_info_area -->

		<div class="progress_bar progress_bar_ty1 progress_bar_ty1_count" role="img" tabindex="0">
			<div class="progress_bar_per_cover">
				<div class="progress_bar_per">
					<div class="per_bar">
						<span class="per_bar_dp dp_ic6" data-pbc="3">
							<span class="text">3단계 완료</span>
						</span>
					</div>
				</div>
			</div>
			<div class="progress_bar_bottom">
				<span class="pbb_start" data-pbcs="0">0단계</span>
				<span class="pbb_end" data-pbce="5">5단계</span>
			</div>
		</div>


	</div>
</div>
<div class="popup_bottom">
	<div class="btn_area">
		{{> cp/button type="3" size="2" b-text="홈으로" }}
		{{> cp/button type="1" size="2" b-text="계산 진행하기" }}
	</div>
</div>
{{/ popup/popup_full}}
<!-- e: Full 팝업 -->


<script>
	$(function(){	

		console.log('aa');
		function updateProgressBarPosition($progressBar) {
			
			// 접근성 관련 문구 생성 후 삽입
			var current = $progressBar.find('[data-pbc]').data('pbc');
			var total = $progressBar.find('[data-pbce]').data('pbce');

			$progressBar.attr('aria-label', '전체 ' + total + '단계 중 ' + current + '단계 완료');
			
			// 전체 넓이
			var $progressBarPer = $progressBar.find('.progress_bar_per');
			var progressBarPerWidth = $progressBarPer.outerWidth(); // 기준 넓이(px)

			// 퍼센트 계산 (소수점 없이)
			var percent = Math.floor((current / total) * 100);       // 현재 진행률(%)

			var pixelWidth = Math.floor((percent / 100) * progressBarPerWidth);  // 진행률 px 환산

			var $perBar = $progressBar.find('.per_bar');
			var $perBarDp = $perBar.find('.per_bar_dp');
			var perBarDpWidth = $perBarDp.outerWidth();

			// console.log('움직이는 컨텐츠 넓이 : ', perBarDpWidth);

			// 초기 클래스 제거
			$perBar.removeClass('pos');
			$perBarDp.removeClass('poe');

			// 앞에 고정하기
			if (pixelWidth < perBarDpWidth / 2) {
				$perBar.addClass('pos');
			} else {
				$perBar.removeClass('pos');
			}

			// 끝으로 보내기
			if (progressBarPerWidth - pixelWidth < perBarDpWidth / 2) {
				$perBar.addClass('poe');
			} else {
				$perBar.removeClass('poe');
			}

			// per_bar 너비 설정
			setTimeout(function(){
				$perBar.addClass('active').css('width', percent + '%');
			}, 100);
		}

		// 여러 개의 .progress_bar_ty1_count 대해 반복 처리
		$('.progress_bar_ty1_count').each(function() {
			var $this = $(this); // 각 progress_bar_ty1을 $this로 참조
			
			// 윈도우 로드 시 updateProgressBarPosition 함수 호출
			$(window).on('load', function () {
				updateProgressBarPosition($this);
			});

			// 리사이즈 시에도 적용
			$(window).on('resize', function () {
				console.log('리사이즈 됨?');
				updateProgressBarPosition($this);
			});
		});
	});
</script>

{{/ layout/default }}
