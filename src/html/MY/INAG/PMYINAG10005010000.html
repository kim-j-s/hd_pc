{{#> layout/default gnbis=true page-title="기본정보 | 마이페이지"}}
	<div id="wrap" class="wrap">
		{{> layout/header_pc bc=true }}
		<div id="container" class="container">
			<div class="content">

				<div class="title_view_wrap">
					<div class="page_title">
						<h2 class="p_title">
							<strong>계약상세조회</strong>
						</h2>
					</div>
				</div>

				<div class="cd_top_wrap">
					<div class="cd_top">
						<div class="badge_wrap">
							<span class="hd_badge outline solid_pastel c_primary size_m">유지</span>
						</div>
						<div class="cd_top_name">
							다이렉트자동차보험(CM)
						</div>
						<p class="cd_price">
							<span class="sr_only">차량번호</span>
							<strong class="won">20보**56</strong>
						</p>

						<div class="progress_bar progress_bar_ty1 progress_bar_ty1_date" role="img" tabindex="0">
							<div class="progress_bar_per_cover">
								<div class="progress_bar_per">
									<div class="per_bar">
										<span class="per_bar_dp dp_ic2">
											<span class="text"></span>
										</span>
									</div>
								</div>
							</div>
							<div class="progress_bar_bottom">
								<span class="pbb_start" data-pbcsdate="2024.01.13">2024.01.13</span>
								<span class="pbb_end" data-pbcedate="2028.01.12">2028.01.12</span>
							</div>
						</div>

						<!-- s: 25-08-19 추가 -->
						<!-- s: 개시전 -->
						<div class="progress_bar progress_bar_ty1 progress_bar_ty1_date before" role="img" tabindex="0">
							<div class="progress_bar_per_cover">
								<div class="progress_bar_per">
									<div class="per_bar active">
										<span class="per_bar_dp dp_ic5">
											<span class="text">개시 전</span>
										</span>
									</div>
								</div>
							</div>
							<div class="progress_bar_bottom">
								<span class="pbb_start" data-pbcsdate="2024.01.13">2024.01.13</span>
								<span class="pbb_end" data-pbcedate="2028.01.12">2028.01.12</span>
							</div>
						</div>
						<!-- e: 개시전 -->

						<!-- s: 만기 D-30 -->
						<div class="progress_bar progress_bar_ty1 progress_bar_ty1_date expired" role="img" tabindex="0">
							<div class="progress_bar_per_cover">
								<div class="progress_bar_per">
									<div class="per_bar">
										<span class="per_bar_dp dp_ic4">
											<span class="text">만기 D-30</span>
										</span>
									</div>
								</div>
							</div>
							<div class="progress_bar_bottom">
								<span class="pbb_start" data-pbcsdate="2024.01.13">2024.01.13</span>
								<span class="pbb_end" data-pbcedate="2028.01.12">2028.01.12</span>
							</div>
						</div>
						<!-- e: 만기 D-30 -->
						<!-- e: 25-08-19 추가 -->

						
					</div>
				</div>

				<div class="tab_wrap">

					<div class="tab_wrap_list_ty1" role="tablist">
						{{>cp/tab_btn tb-text="기본정보" tb-id="01" tb-active=true}}
						{{>cp/tab_btn tb-text="보장내용" tb-id="02"}}
						{{>cp/tab_btn tb-text="특약사항" tb-id="03"}}
					</div>

					<!-- s: 기본정보 -->
					<div class="tab_wrap_content active" role="tabpanel" aria-labelledby="tab01" id="tabPanel01">
						<h3 class="title_h3">기본정보</h3>
						<div class="table_wrap">
							<table class="table">
								<!-- s: 25-09-02 수정 -->
								<caption>계약번호, 계약상태, 차량번호, 보험기간, 총 차량가액 제공</caption>
								<!-- ‘차대번호’ 노출 시 caption -->
								<!-- 
									<caption>계약번호, 계약상태, 차대번호, 보험기간, 총 차량가액 제공</caption>
								-->
								<!-- ‘차대번호’ 노출 시 caption -->
								<!-- e: 25-09-02 수정 -->
								<colgroup>
									
									<col style="width: 160px;">
									<col style="width: auto;">
									
								</colgroup>
								<tbody>
									<tr>
										<th scope="row">계약번호</th>
										<td>L1234****901</td>
									</tr>
									<tr>
										<th scope="row">계약상태</th>
										<td>실효(2023.11.11)</td>
									</tr>
									<tr>
										<th scope="row">차량번호</th>
										<td></td>
									</tr>
									<!-- 미확정 계약일 경우 ‘차량번호’ -> ‘차대번호’로 노출 -->
									<tr>
										<th scope="row">차대번호</th>
										<td></td>
									</tr>
									<!-- 미확정 계약일 경우 ‘차량번호’ -> ‘차대번호’로 노출 -->
									<tr>
										<th scope="row">보험기간</th>
										<td>1,508만원</td>
									</tr>
									<tr>
										<th scope="row">총 차량가액</th>
										<td>1,508만원</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="btn_area center">
							{{> cp/button type="3" size="3" b-text="차량번호 확정/변경" atag="true"}}
						</div>

						<div class="divider_ty1"></div>

						<h3 class="title_h3">가입자 정보</h3>
						<div class="table_wrap">
							<table class="table">
								<caption>계약자, 피보험자, 가입경력인정자1, 가입경력인정자2, 휴대폰번호, 전화번호, 우편물 받는 곳 제공</caption>
								<colgroup>
									
									<col style="width: 160px;">
									<col style="width: auto;">
									
								</colgroup>
								<tbody>
									<tr>
										<th scope="row">계약자</th>
										<td>하*현(991123-1******)</td>
									</tr>
									<tr>
										<th scope="row">피보험자</th>
										<td>하*현(991123-1******)</td>
									</tr>
									<tr>
										<th scope="row">가입경력인정자1</th>
										<td>하*현(991123-1******)</td>
									</tr>
									<tr>
										<th scope="row">가입경력인정자2</th>
										<td>-</td>
									</tr>
									<tr>
										<th scope="row">휴대폰번호</th>
										<td>010-****-1234</td>
									</tr>
									<tr>
										<th scope="row">전화번호</th>
										<td>010-****-1234</td>
									</tr>
									<tr>
										<th scope="row">우편물 받는 곳</th>
										<td>(회사) 04535 서울 중구 명동2길 20, 현대해상명동사옥</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="btn_area center">
							{{> cp/button type="3" size="3" b-text="개인정보 변경" atag="true"}}
							{{> cp/button type="3" size="3" b-text="가입경력인정자 신청/변경" atag="true"}}
						</div>

						<div class="divider_ty1"></div>

						<h3 class="title_h3">보험료 납입정보</h3>

						<div class="table_wrap">
							<table class="table">
								<caption>총 납입보험, 납입방법, 다음회차 납입보험료, 다음회차 납입예정일 제공</caption>
								<colgroup>
									
									<col style="width: 160px;">
									<col style="width: auto;">
									
								</colgroup>
								<tbody>
									<tr>
										<th scope="row">총 납입보험료</th>
										<td>1,345,000원</td>
									</tr>
									<tr>
										<th scope="row">납입방법</th>
										<td>일시납</td>
									</tr>
									<tr>
										<th scope="row">다음회차 납입보험료</th>
										<td>20,000원</td>
									</tr>
									<tr>
										<th scope="row">다음회차 납입예정일</th>
										<td>2025.03.24</td>
									</tr>
								</tbody>
							</table>
						</div>

						<div class="btn_area center">
							{{> cp/button type="3" size="3" b-text="납입내역 조회" atag=true}}
							{{> cp/button type="3" size="3" b-text="마일리지 할인특약 가입" atag=true}}
							<!-- 마일리지 할인특약 가입상태인 경우 노출 -->
							<!-- 
							{{> cp/button type="3" size="3" b-text="마일리지 (예상)환급금 조회" atag=true}}
							-->
							<!-- 마일리지 할인특약 가입상태인 경우 노출 -->
						</div>

						<div class="divider_ty1"></div>

						<h3 class="title_h3">계약담당자</h3>
						<ul class="contact_list">
							<li>
								<div class="item person">
									<div class="inner">
										<div class="name">홍길동</div>
										<div class="tel">010-1234-5678</div>
									</div>
								</div>
							</li>
							<li>
								<div class="item spot">
									<div class="inner">
										<div class="name">서울사업부 명동지점</div>
										<div class="tel">010-1234-5678</div>
									</div>
								</div>
							</li>
						</ul>

						
						<!-- s: 이용안내 -->
						<!-- dp-active=true -->
						<div class="acd_item acd_item_ty4">
							{{#> cp/accordion ac-title="이용안내" ac-active=true}}
							<ul class="list_depth">
								<li>
									
									<!-- s: 25-09-18 수정 -->
									이 보험계약은 예금자보호법에 따라 해약환급금(또는 만기 시 보험금)에 기타지급금을 합한 금액이 1인당 "1억원까지"(본 보험회사의 여타 보호상품과 합산)보호됩니다. 이와 별도로 본 보험회사 보호상품의 사고보험금을 합산한 금액이 1인당 "1억원까지" 보호됩니다. 다만, 보험계약자 및 보험료납부자가 법인인 보험계약의 경우에는 보호되지 않습니다.
									<!-- e: 25-09-18 수정 -->
									
								</li>
							</ul>
							{{/ cp/accordion }}
						</div>
						<!-- e: 이용안내 -->
						
					</div>
					<!-- e: 기본정보 -->

					<!-- s: 보장내용 -->
					<div class="tab_wrap_content" role="tabpanel" aria-labelledby="tab02" id="tabPanel02">

						<h3 class="title_h3">보장내용</h3>

						<ul class="opt_select_list opt_case4">
							<li class="option">
								<div class="item">
									<div class="data_l">
										<span class="name">대인배상Ⅰ</span>
										<span class="date">가입</span>
									</div>
									<div class="data_r">
										<span class="price">138,550원</span>
									</div>
								</div>
							</li>
							<li class="option">
								<div class="item">
									<div class="data_l">
										<span class="name">대물(의무)</span>
										<span class="date">2천만원</span>
									</div>
									<div class="data_r">
										<span class="price">293,390원</span>
									</div>
								</div>
							</li>
							<li class="option">
								<div class="item">
									<div class="data_l">
										<span class="name">대인배상Ⅱ</span>
										<span class="date">무한(의무담보 포함) </span>
									</div>
									<div class="data_r">
										<span class="price">243,970원</span>
									</div>
								</div>
							</li>
							<li class="option">
								<div class="item">
									<div class="data_l">
										<span class="name">대물(선택)</span>
										<span class="date">3억원(의무담보 포함) </span>
									</div>
									<div class="data_r">
										<span class="price">82,760원</span>
									</div>
								</div>
							</li>
							<li class="option">
								<div class="item">
									<div class="data_l">
										<span class="name">자동차상해</span>
										<span class="date">2억원/5천만원</span>
									</div>
									<div class="data_r">
										<span class="price">46,600원</span>
									</div>
								</div>
							</li>
							<li class="option">
								<div class="item">
									<div class="data_l">
										<span class="name">긴급출동특약</span>
										<span class="date">하이카서비스(10km) </span>
									</div>
									<div class="data_r">
										<span class="price">25,870원</span>
									</div>
								</div>
							</li>
							<li class="option">
								<div class="item">
									<div class="data_l">
										<span class="name">특약보험료</span>
										<span class="date">1개 특약 선택</span>
									</div>
									<div class="data_r">
										<span class="price">20원</span>
									</div>
								</div>
							</li>
						</ul>

						<div class="info_gray">
							<dl class="middle">
								<dt>보장보험료 합계</dt>
								<dd class="point">
									<strong class="big">1,155,150원</strong>
								</dd>
							</dl>
						</div>

						<div class="btn_area center">
							{{> cp/button type="3" size="3" b-text="담보/특약 변경" atag=true}}
						</div>

						
						<!-- s: 이용안내 -->
						<!-- dp-active=true -->
						<div class="acd_item acd_item_ty4">
							{{#> cp/accordion ac-title="이용안내" ac-active=true}}
							<ul class="list_depth">
								<li>
									
									<!-- s: 25-09-18 수정 -->
									이 보험계약은 예금자보호법에 따라 해약환급금(또는 만기 시 보험금)에 기타지급금을 합한 금액이 1인당 "1억원까지"(본 보험회사의 여타 보호상품과 합산)보호됩니다. 이와 별도로 본 보험회사 보호상품의 사고보험금을 합산한 금액이 1인당 "1억원까지" 보호됩니다. 다만, 보험계약자 및 보험료납부자가 법인인 보험계약의 경우에는 보호되지 않습니다.
									<!-- e: 25-09-18 수정 -->
									
								</li>
							</ul>
							{{/ cp/accordion }}
						</div>
						<!-- e: 이용안내 -->
						
					</div>
					<!-- e: 보장내용 -->
					 
					<!-- s: 특약사항 -->
					<div class="tab_wrap_content" role="tabpanel" aria-labelledby="tab03" id="tabPanel02">

						<h3 class="title_h3">특약사항</h3>
						<ul class="list_ty3">
							<li>부부 한정</li>
							<li>만 48세 이상</li>
							<li>최저연령자 홍길동(본인)</li>
							<li>상해용품 지원</li>
							<li>자기차량손해보장확대 특별약관</li>
						</ul>

						<div class="btn_area center">
							{{> cp/button type="3" size="3" b-text="단기운전자확대 특약 신청/변경" }}
							{{> cp/button type="3" size="3" b-text="운전자 범위/연령 변경" atag="true"}}
							{{> cp/button type="3" size="3" b-text="할인특약가입" atag="true"}}
						</div>

						<div class="divider_ty1"></div>

						<h3 class="title_h3">특별요율(특별약관)</h3>
						<ul class="list_ty3">
							<li>다른 자동차 운전담보</li>
							<li>Eco Point 리워드 특별약관(자차)</li>
							<li>ABS 장착요율</li>
							<li>에어백요율(운전석&보조석)</li>
							<li>일시납</li>
						</ul>

						<div class="divider_ty1"></div>
						<h3 class="title_h3">물적할증기준금액</h3>
						<ul class="list_ty3">
							<li>200만원</li>
						</ul>

						
						<!-- s: 이용안내 -->
						<!-- dp-active=true -->
						<div class="acd_item acd_item_ty4">
							{{#> cp/accordion ac-title="이용안내" ac-active=true}}
							<ul class="list_depth">
								<li>
									
									<!-- s: 25-09-18 수정 -->
									이 보험계약은 예금자보호법에 따라 해약환급금(또는 만기 시 보험금)에 기타지급금을 합한 금액이 1인당 "1억원까지"(본 보험회사의 여타 보호상품과 합산)보호됩니다. 이와 별도로 본 보험회사 보호상품의 사고보험금을 합산한 금액이 1인당 "1억원까지" 보호됩니다. 다만, 보험계약자 및 보험료납부자가 법인인 보험계약의 경우에는 보호되지 않습니다.
									<!-- e: 25-09-18 수정 -->
									
								</li>
							</ul>
							{{/ cp/accordion }}
						</div>
						<!-- e: 이용안내 -->
						
					</div>
					<!-- e: 특약사항 -->
				</div>

				<div class="divider_ty1"></div>

				<div class="suggestion_list_wrap">
					<div class="title_h4"><strong>어떤 서비스가 필요하세요?</strong></div>
					<div class="item_wrap">
						<!-- s: 25-10-21 수정 -->
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">단기운전자특약확대 특약 신청</span></button>
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">마일리지 할인특약 사진 등록</span></button>
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">자동차사고 처리현황 조회</span></button>
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">운전자 범위/연령 변경</span></button>
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">자동차보험가입증명서</span></button>
						<!-- e: 25-10-21 수정 -->
					</div>
				</div>
				<!-- s: 하단 버튼 영역 -->
				<div class="bottom_fix_wrap">
					<div class="btn_area center">
						<!-- s: 25-09-09 수정 -->
						{{> cp/button type="3" size="1" b-text="목록으로"}}
						<!-- e: 25-09-09 수정 -->
					</div>
				</div>
				<!-- s: 하단 버튼 영역 -->
			</div>
		</div>


	</div>

	<!-- s: popup area -->

	 
	<!-- e: popup area -->


	<script>
		$(function(){		
	
		function updateProgressBarPosition($progressBar) {
				
			// 접근성 관련 문구 생성 후 삽입
			var current = $progressBar.find('[data-pbc]').data('pbc');
			var total = $progressBar.find('[data-pbce]').data('pbce');
	
			$progressBar.attr('aria-label', '전체 ' + total + '회 중 ' + current + '회 납입');
			
			// 전체 넓이
			var $progressBarPer = $progressBar.find('.progress_bar_per');
			var progressBarPerWidth = $progressBarPer.outerWidth(); // 기준 넓이(px)
	
			// 퍼센트 계산 (소수점 없이)
			var percent = Math.floor((current / total) * 100);       // 현재 진행률(%)
	
			var pixelWidth = Math.floor((percent / 100) * progressBarPerWidth);  // 진행률 px 환산
	
			var $perBar = $progressBar.find('.per_bar');
			var $perBarDp = $perBar.find('.per_bar_dp');
			var perBarDpWidth = $perBarDp.outerWidth();
	
			// console.log('움직이는 컨텐츠 넓이 : ', perBarDpWidth);
	
			// 초기 클래스 제거
			$perBar.removeClass('pos');
			$perBarDp.removeClass('poe');
	
			// 앞에 고정하기
			if (pixelWidth < perBarDpWidth / 2) {
				$perBar.addClass('pos');
			} else {
				$perBar.removeClass('pos');
			}
	
			// 끝으로 보내기
			if (progressBarPerWidth - pixelWidth < perBarDpWidth / 2) {
				$perBar.addClass('poe');
			} else {
				$perBar.removeClass('poe');
			}
	
			// per_bar 너비 설정
			setTimeout(function(){
				$perBar.addClass('active').css('width', percent + '%');
			}, 100);
		}
	
		// 여러 개의 .progress_bar_ty1_count 대해 반복 처리
		$('.progress_bar_ty1_count').each(function() {
			var $this = $(this); // 각 progress_bar_ty1을 $this로 참조
			
			// 윈도우 로드 시 updateProgressBarPosition 함수 호출
			$(window).on('load', function () {
				updateProgressBarPosition($this);
			});
	
			// 리사이즈 시에도 적용
			$(window).on('resize', function () {
				console.log('리사이즈 됨?');
				updateProgressBarPosition($this);
			});
		});
	
	
		function updateProgressBarWithDate() {
	
			// progress_bar_ty1에 대해 각 요소 선택
			$('.progress_bar_ty1_date').each(function() {
				var $progressBar = $(this);
	
				// 시작일과 종료일을 data 속성으로부터 가져오기
				var startDate = $progressBar.find('[data-pbcsdate]').data('pbcsdate');
				var endDate = $progressBar.find('[data-pbcedate]').data('pbcedate');
	
				
	
				// 날짜 형식: 'YYYY.MM.DD' → Date 객체로 변환
				var start = new Date(startDate.replace(/\./g, '/'));
				var end = new Date(endDate.replace(/\./g, '/'));
				var now = new Date();  // 현재 날짜
	
				// 전체 기간 계산 (밀리초 단위)
				var totalTime = end - start;
				// 현재 진행 시간 계산 (밀리초 단위)
				var currentTime = now - start;
	
				// 진행률 계산 (소수점 없이)
				var percent = Math.floor((currentTime / totalTime) * 100);
	
				// D-XX 형식으로 남은 일수 계산
				var remainingDays = Math.ceil((end - now) / (1000 * 60 * 60 * 24));
	
				// 'D-XX' 형식으로 .text에 삽입
				$progressBar.find('.per_bar_dp .text').text('D-' + remainingDays);
	
				// 접근성 관련 문구 생성 후 삽입
				//25-08-19
				const isExpired = $progressBar.hasClass('expired');
				const isBefore = $progressBar.hasClass('before');
				let labelText = `만기일 ${remainingDays}일 전`;
				let ariaLabel = `${labelText} - 시작일:${startDate}, 종료일:${endDate}`;

				if (isExpired || isBefore) {
					if (isExpired) {
						labelText = '만기 D-30';
						ariaLabel = `만기 30일전 - 시작일:${startDate}, 종료일:${endDate}`;
					} else {
						labelText = '개시전';
						ariaLabel = `개시전 - 시작일:${startDate}, 종료일:${endDate}`;
					}
					$progressBar.find('.per_bar_dp .text').text(labelText);
				}
				$progressBar.attr('aria-label', ariaLabel);	
				//25-08-19

				// 전체 넓이
				var $progressBarPer = $progressBar.find('.progress_bar_per');
				var progressBarPerWidth = $progressBarPer.outerWidth(); // 기준 넓이(px)
	
				// 진행률을 px로 환산
				var pixelWidth = Math.floor((percent / 100) * progressBarPerWidth);
	
				var $perBar = $progressBar.find('.per_bar');
				var $perBarDp = $perBar.find('.per_bar_dp');
				var perBarDpWidth = $perBarDp.outerWidth();
	
				// 초기 클래스 제거
				$perBar.removeClass('pos');
				$perBarDp.removeClass('poe');
	
				// 앞에 고정하기
				if(pixelWidth < perBarDpWidth / 2) {
						console.log('앞에 처박기');
						$perBar.addClass('pos');
				}
	
				// 끝으로 보내기
				if(progressBarPerWidth - pixelWidth < perBarDpWidth / 2) {
						console.log('끝으로 보내기');
						$perBar.addClass('poe');
				}
	
				// 진행률에 따른 per_bar 너비 설정
				setTimeout(function(){
					//25-08-19
					if (!$progressBar.hasClass('before')) {
						$perBar.addClass('active').css('width', $progressBar.hasClass('expired') ? '70%' : percent + '%');
					}
					//25-08-19
				}, 100);
			});
			}
	
			$(window).on('load', function () {
			updateProgressBarWithDate();
			});
	
			// 리사이즈 시에도 적용
			$(window).on('resize', function () {
			updateProgressBarWithDate();
			});
	
	});
	
	</script>

{{/ layout/default }}