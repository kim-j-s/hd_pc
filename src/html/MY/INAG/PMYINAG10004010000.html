{{#> layout/default gnbis=true page-title="기본정보 | 마이페이지"}}
	<div id="wrap" class="wrap">
		{{> layout/header_pc bc=true }}
		<div id="container" class="container">
			<div class="content">

				<div class="title_view_wrap">
					<div class="page_title">
						<h2 class="p_title">
							<strong>계약상세조회</strong>
						</h2>
					</div>
				</div>
				<div class="cd_top_wrap">
					<div class="cd_top">
						<div class="badge_wrap">
							<span class="hd_badge outline solid_pastel c_primary size_m">유지</span>
						</div>
						<div class="cd_top_name">
							현대해상단체상해보험(직급전용)
						</div>

						<div class="progress_bar progress_bar_ty1 progress_bar_ty1_date" role="img" tabindex="0">
							<div class="progress_bar_per_cover">
								<div class="progress_bar_per">
									<div class="per_bar">
										<span class="per_bar_dp dp_ic2">
											<span class="text"></span>
										</span>
									</div>
								</div>
							</div>
							<div class="progress_bar_bottom">
								<span class="pbb_start" data-pbcsdate="2024.01.13">2024.01.13</span>
								<span class="pbb_end" data-pbcedate="2028.01.12">2028.01.12</span>
							</div>
						</div>

						
						<!-- s: 개시전 -->
						<div class="progress_bar progress_bar_ty1 progress_bar_ty1_date before" role="img" tabindex="0">
							<div class="progress_bar_per_cover">
								<div class="progress_bar_per">
									<div class="per_bar active">
										<span class="per_bar_dp dp_ic5">
											<span class="text">개시 전</span>
										</span>
									</div>
								</div>
							</div>
							<div class="progress_bar_bottom">
								<span class="pbb_start" data-pbcsdate="2024.01.13">2024.01.13</span>
								<span class="pbb_end" data-pbcedate="2028.01.12">2028.01.12</span>
							</div>
						</div>
						<!-- e: 개시전 -->
						
					</div>
				</div>


				<div class="tab_wrap">

					<div class="tab_wrap_list_ty1" role="tablist">
						{{>cp/tab_btn tb-text="기본정보" tb-id="01" tb-active=true}}
						{{>cp/tab_btn tb-text="보장내용" tb-id="02"}}
					</div>

					<!-- s: 기본정보 -->
					<div class="tab_wrap_content active" role="tabpanel" aria-labelledby="tab01" id="tabPanel01">
						<h3 class="title_h3">기본정보</h3>
						<div class="table_wrap">
							<table class="table">
								<caption>계약번호, 계약상태, 보험기간 제공</caption>
								<colgroup>
									
									<col style="width:160px;">
									<col style="width:auto">
									
								</colgroup>
								<tbody>
									<tr>
										<th scope="row">계약번호</th>
										<td>L1234****901</td>
									</tr>
									<tr>
										<th scope="row">계약상태</th>
										<td>실효(2023.11.11)</td>
									</tr>
									<tr>
										<th scope="row">보험기간</th>
										<td>2015.11.23~2037.11.23</td>
									</tr>
								</tbody>
							</table>
						</div>

						<div class="divider_ty1"></div>

						<h3 class="title_h3">가입자 정보</h3>
						<div class="table_wrap">
							<table class="table">
								<caption>계약자, 피보험자 제공</caption>
								<colgroup>
									
									<col style="width:160px;">
									<col style="width:auto">
									
								</colgroup>
								<tbody>
									<tr>
										<th scope="row">계약자</th>
										<td>하*현(991123-1******)</td>
									</tr>
									<tr>
										<th scope="row">피보험자</th>
										<td>하*현(991123-1******)</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="btn_area center">
							{{> cp/button type="3" size="3" b-text="개인정보 변경" atag="true"}}
						</div>
					</div>
					<!-- e: 기본정보 -->

					<!-- s: 보장내용 -->
					<div class="tab_wrap_content" role="tabpanel" aria-labelledby="tab02" id="tabPanel02">

						<h3 class="title_h3">보장내용</h3>
						<div class="opt_select_list opt_case4">
							<a href="#" class="option" role="button">
								<div class="item">
									<div class="data_l">
										<span class="name">기본계약(상해사망)</span>
										<span class="date">2021.01.15~2055.01.15</span>
									</div>
									<div class="data_r">
										<span class="price">1억 5,000만원</span>
									</div>
								</div>
							</a>
							<a href="#" class="option" role="button">
								<div class="item">
									<div class="data_l">
										<span class="name">기본계약(상해후유장해)</span>
										<span class="date">2021.01.15~2055.01.15</span>
									</div>
									<div class="data_r">
										<span class="price">5,000만원</span>
									</div>
								</div>
							</a>
							<a href="#" class="option" role="button">
								<div class="item">
									<div class="data_l">
										<span class="name">상해사망추가담보</span>
										<span class="date">2021.01.15~2055.01.15</span>
									</div>
									<div class="data_r">
										<span class="price">5,000만원</span>
									</div>
								</div>
							</a>
							<a href="#" class="option" role="button">
								<div class="item">
									<div class="data_l">
										<span class="name">중증화상/부식진단담보</span>
										<span class="date">2021.01.15~2055.01.15</span>
									</div>
									<div class="data_r">
										<span class="price">2,000만원</span>
									</div>
								</div>
							</a>
							<!-- CASE. 보장(보험)기간이 없는 경우 -->
							<a href="#" class="option" role="button">
								<div class="item">
									<div class="data_l">
										<span class="name">기본계약(자동차사고부상(운전자,1-7급))</span>
									</div>
									<div class="data_r">
										<span class="price">1억 5,000만원</span>
									</div>
								</div>
							</a>
							<a href="#" class="option" role="button">
								<div class="item">
									<div class="data_l">
										<span class="name">교통상해후유장해(운전자,50%이상)담보</span>
									</div>
									<div class="data_r">
										<span class="price">5,000만원</span>
									</div>
								</div>
							</a>
							<a href="#" class="option" role="button">
								<div class="item">
									<div class="data_l">
										<span class="name">스프링쿨러누출손해</span>
									</div>
									<div class="data_r">
										<span class="price">5,000만원</span>
									</div>
								</div>
							</a>
							<a href="#" class="option" role="button">
								<div class="item">
									<div class="data_l">
										<span class="name">화재손해</span>
									</div>
									<div class="data_r">
										<span class="price">1,000만원</span>
									</div>
								</div>
							</a>
							<!-- CASE. 보장(보험)기간이 없는 경우 -->
						</div>

					</div>
					<!-- e: 보장내용 -->
				</div>


				<!-- s: 이용안내 -->
				<!-- dp-active=true -->
				
				<div class="acd_item acd_item_ty4">
				{{#> cp/accordion ac-title="이용안내" ac-active=true}}
				
				<ul class="list_depth">
					<li>
						단체보험은 피보험자 추가, 탈퇴, 변경 등이 계약자(법인) 통보에 따라 이루어지기 때문에 변경사항이 실시간으로 반영되지 않습니다.
					</li>
					
					<li>
						계약자 통보에 따라 현대해상이 보유한 정보를 근거로 조회되므로 계약이 조회되지 않는 경우, 재직 중인 회사 또는 카드사 등의 회원가입사에 계약 반영을 문의해주세요.
						<ul>
							<li>
								예) A기업이 직원을 피보험자로 하는 단체보험에 가입한 경우<br>
								① 신입사원 김OO 입사(02.01), 현대해상에 피보험자 추가 통보(03.01) → 김OO님이 02.15에 계약조회 시 단체피보험자로 조회되지 않음<br>
								② 직원 이OO 퇴사(06.01), 현대해상에 피보험자 탈퇴 통보(12.01) → 이OO님이 07.01에 계약조회 시 단체피보험자로 조회되지만 유효하지 않음
							</li>
						</ul>
					</li>
					<li>
						단체보험은 다수의 보험사가 담보 또는 가입금액을 분담해서 인수하는 계약이 가능합니다.<br>
						
						해당 서비스에서 조회되는 내용은 현대해상이 인수한 담보와 가입금액이 기준이므로, 조회되지 않는 담보는 재직 중인 회사 또는 카드사 등의 회원가입사에 문의해주세요.
						
						<ul>
							<li>
								예) A손해보험사(상해사망 3천만원, 상해입원일당 2만원)와 현대해상(상해사망 2천만원)으로 분담된 계약을 조회한 경우 → 조회 시 '상해사망 2천만원'만 보장내용으로 표시됨
							</li>
						</ul>
						
					</li>
				</ul>
				{{/ cp/accordion }}
				</div>
				<!-- e: 이용안내 -->

				<div class="divider_ty1"></div>

				<div class="suggestion_list_wrap">
					<div class="title_h4"><strong>어떤 서비스가 필요하세요?</strong></div>
					<div class="item_wrap">
						
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">보험금 청구 안내</span></button>
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">보험계약대출 신청</span></button>
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">보험증권</span></button>
						<button type="button" class="tag_item size_m" title="페이지 이동"><span class="text">자동이체계좌 신청/변경</span></button>
						
					</div>
				</div>
				<!-- s: 하단 버튼 영역 -->
				<div class="bottom_fix_wrap">
					<div class="btn_area center">
						
						{{> cp/button type="3" size="1" b-text="목록으로"}}
						
					</div>
				</div>
				<!-- s: 하단 버튼 영역 -->
			</div>
		</div>
	</div>

	<!-- s: popup area -->


	 
	<!-- e: popup area -->


	<script>
		$(function(){		
	
		function updateProgressBarPosition($progressBar) {
				
			// 접근성 관련 문구 생성 후 삽입
			var current = $progressBar.find('[data-pbc]').data('pbc');
			var total = $progressBar.find('[data-pbce]').data('pbce');
	
			$progressBar.attr('aria-label', '전체 ' + total + '회 중 ' + current + '회 납입');
			
			// 전체 넓이
			var $progressBarPer = $progressBar.find('.progress_bar_per');
			var progressBarPerWidth = $progressBarPer.outerWidth(); // 기준 넓이(px)
	
			// 퍼센트 계산 (소수점 없이)
			var percent = Math.floor((current / total) * 100);       // 현재 진행률(%)
	
			var pixelWidth = Math.floor((percent / 100) * progressBarPerWidth);  // 진행률 px 환산
	
			var $perBar = $progressBar.find('.per_bar');
			var $perBarDp = $perBar.find('.per_bar_dp');
			var perBarDpWidth = $perBarDp.outerWidth();
	
			// console.log('움직이는 컨텐츠 넓이 : ', perBarDpWidth);
	
			// 초기 클래스 제거
			$perBar.removeClass('pos');
			$perBarDp.removeClass('poe');
	
			// 앞에 고정하기
			if (pixelWidth < perBarDpWidth / 2) {
				$perBar.addClass('pos');
			} else {
				$perBar.removeClass('pos');
			}
	
			// 끝으로 보내기
			if (progressBarPerWidth - pixelWidth < perBarDpWidth / 2) {
				$perBar.addClass('poe');
			} else {
				$perBar.removeClass('poe');
			}
	
			// per_bar 너비 설정
			setTimeout(function(){
				$perBar.addClass('active').css('width', percent + '%');
			}, 100);
		}
	
		// 여러 개의 .progress_bar_ty1_count 대해 반복 처리
		$('.progress_bar_ty1_count').each(function() {
			var $this = $(this); // 각 progress_bar_ty1을 $this로 참조
			
			// 윈도우 로드 시 updateProgressBarPosition 함수 호출
			$(window).on('load', function () {
				updateProgressBarPosition($this);
			});
	
			// 리사이즈 시에도 적용
			$(window).on('resize', function () {
				console.log('리사이즈 됨?');
				updateProgressBarPosition($this);
			});
		});
	
	
		function updateProgressBarWithDate() {
	
			// progress_bar_ty1에 대해 각 요소 선택
			$('.progress_bar_ty1_date').each(function() {
				var $progressBar = $(this);
	
				// 시작일과 종료일을 data 속성으로부터 가져오기
				var startDate = $progressBar.find('[data-pbcsdate]').data('pbcsdate');
				var endDate = $progressBar.find('[data-pbcedate]').data('pbcedate');
	
				
	
				// 날짜 형식: 'YYYY.MM.DD' → Date 객체로 변환
				var start = new Date(startDate.replace(/\./g, '/'));
				var end = new Date(endDate.replace(/\./g, '/'));
				var now = new Date();  // 현재 날짜
	
				// 전체 기간 계산 (밀리초 단위)
				var totalTime = end - start;
				// 현재 진행 시간 계산 (밀리초 단위)
				var currentTime = now - start;
	
				// 진행률 계산 (소수점 없이)
				var percent = Math.floor((currentTime / totalTime) * 100);
	
				// D-XX 형식으로 남은 일수 계산
				var remainingDays = Math.ceil((end - now) / (1000 * 60 * 60 * 24));
	
				// 'D-XX' 형식으로 .text에 삽입
				$progressBar.find('.per_bar_dp .text').text('D-' + remainingDays);
	
				// 접근성 관련 문구 생성 후 삽입
				
				const isExpired = $progressBar.hasClass('expired');
				const isBefore = $progressBar.hasClass('before');
				let labelText = `만기일 ${remainingDays}일 전`;
				let ariaLabel = `${labelText} - 시작일:${startDate}, 종료일:${endDate}`;

				if (isExpired || isBefore) {
					if (isExpired) {
						labelText = '만기 D-30';
						ariaLabel = `만기 30일전 - 시작일:${startDate}, 종료일:${endDate}`;
					} else {
						labelText = '개시전';
						ariaLabel = `개시전 - 시작일:${startDate}, 종료일:${endDate}`;
					}
					$progressBar.find('.per_bar_dp .text').text(labelText);
				}
				$progressBar.attr('aria-label', ariaLabel);	
				
	
				// 전체 넓이
				var $progressBarPer = $progressBar.find('.progress_bar_per');
				var progressBarPerWidth = $progressBarPer.outerWidth(); // 기준 넓이(px)
	
				// 진행률을 px로 환산
				var pixelWidth = Math.floor((percent / 100) * progressBarPerWidth);
	
				var $perBar = $progressBar.find('.per_bar');
				var $perBarDp = $perBar.find('.per_bar_dp');
				var perBarDpWidth = $perBarDp.outerWidth();
	
				// 초기 클래스 제거
				$perBar.removeClass('pos');
				$perBarDp.removeClass('poe');
	
				// 앞에 고정하기
				if(pixelWidth < perBarDpWidth / 2) {
						console.log('앞에 처박기');
						$perBar.addClass('pos');
				}
	
				// 끝으로 보내기
				if(progressBarPerWidth - pixelWidth < perBarDpWidth / 2) {
						console.log('끝으로 보내기');
						$perBar.addClass('poe');
				}
	
				// 진행률에 따른 per_bar 너비 설정
				setTimeout(function(){
						
						if (!$progressBar.hasClass('before')) {
							$perBar.addClass('active').css('width', $progressBar.hasClass('expired') ? '70%' : percent + '%');
						}
						
				}, 100);
			});
			}
	
			$(window).on('load', function () {
			updateProgressBarWithDate();
			});
	
			// 리사이즈 시에도 적용
			$(window).on('resize', function () {
			updateProgressBarWithDate();
			});
	
	});
	
	</script>

{{/ layout/default }}